<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Proximity Flow &#8212; The Italian EUDI Wallet implementation profile version: latest documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic_mod.css?v=9b2032db" />
    <script src="_static/documentation_options.js?v=edb75691"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/petite-vue.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="index.html" title="Go to homepage"><img src="https://avatars.githubusercontent.com/u/15377824?s=48&v=4"/></a></h1>
            <a id="source_link" href="https://github.com/italia/eudi-wallet-it-docs">
    
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path fill="white" d="M503.5 204.6L502.8 202.8L433.1 21.02C431.7 17.45 429.2 14.43 425.9 12.38C423.5 10.83 420.8 9.865 417.9 9.57C415 9.275 412.2 9.653 409.5 10.68C406.8 11.7 404.4 13.34 402.4 15.46C400.5 17.58 399.1 20.13 398.3 22.9L351.3 166.9H160.8L113.7 22.9C112.9 20.13 111.5 17.59 109.6 15.47C107.6 13.35 105.2 11.72 102.5 10.7C99.86 9.675 96.98 9.295 94.12 9.587C91.26 9.878 88.51 10.83 86.08 12.38C82.84 14.43 80.33 17.45 78.92 21.02L9.267 202.8L8.543 204.6C-1.484 230.8-2.72 259.6 5.023 286.6C12.77 313.5 29.07 337.3 51.47 354.2L51.74 354.4L52.33 354.8L158.3 434.3L210.9 474L242.9 498.2C246.6 500.1 251.2 502.5 255.9 502.5C260.6 502.5 265.2 500.1 268.9 498.2L300.9 474L353.5 434.3L460.2 354.4L460.5 354.1C482.9 337.2 499.2 313.5 506.1 286.6C514.7 259.6 513.5 230.8 503.5 204.6z"/>
        </svg>
    
</a>
        

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><ul>
<li class="toctree-l1"><a class="reference internal" href="ssi-introduction.html">The Digital Identity Wallet Paradigm</a></li>
<li class="toctree-l1"><a class="reference internal" href="defined-terms.html">Normative Language and Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="defined-terms.html#defined-terms">Defined Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="trust.html">The Infrastructure of Trust</a></li>
<li class="toctree-l1"><a class="reference internal" href="wallet-solution.html">Wallet Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="wallet-attestation.html">Wallet Attestation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid-eaa-data-model.html">PID/(Q)EAA Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid-eaa-issuance.html">PID/(Q)EAA Issuance</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid-eaa-entity-configuration.html">Entity Configuration of PID/(Q)EAA Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="authentic-sources.html">Authentic Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="relying-party-solution.html">Relying Party Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="relying-party-entity-configuration.html">Entity Configuration of Relying Parties</a></li>
<li class="toctree-l1"><a class="reference internal" href="revocation-lists.html">Credential Lifecycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="pseudonyms.html">Pseudonyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="backup-restore.html">backup-restore.rst</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Cryptographic Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="standards.html">Technical References</a></li>
</ul>

        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="proximity-flow">
<span id="proximity-flow-sec"></span><h1>Proximity Flow<a class="headerlink" href="#proximity-flow" title="Link to this heading">¶</a></h1>
<p>This section describes how a Verifier requests the presentation of an <em>mDoc-CBOR</em> Credential to a Wallet Instance according to the <em>ISO 18013-5 Specification</em>. Only <em>Supervised Device Retrieval flow</em> is supported in this technical implementation profile.</p>
<p>The presentation phase is divided into three sub-phases:</p>
<blockquote>
<div><p>1. <strong>Device Engagement</strong>: This subphase begins when the User is prompted to disclose certain attributes from the mDoc(s). The objective of this subphase is to establish a secure communication channel between the Wallet Instance and the Verifier App, so that the mDoc requests and responses can be exchanged during the communication subphase.
The messages exchanged in this subphase are transmitted through short-range technologies to limit the possibility of interception and eavesdropping.
This technical implementation profile exclusively supports QR code for Device Engagement.</p>
<p>2. <strong>Session establishment</strong>: During the session establishment phase, the Verifier App sets up a secure connection. All data transmitted over this connection is encrypted using a session key, which is known to both the Wallet Instance and the Verifier at this stage.
The established session MAY be terminated based on the conditions as detailed in [ISO18013-5#9.1.1.4].</p>
<p>3. <strong>Communication - Device Retrieval</strong>: The Verifier App encrypts the mDoc request with the appropriate session key and sends it to the Wallet Instance together with its public key in a session establishment message. The mDoc uses the data from the session establishment message to derive the session key and decrypt the mDoc request.
During the communication subphase, the Verifier App has the option to request information from the Wallet using mDoc requests and responses. The primary mode of communication is the secure channel established during the session setup. The Wallet Instance encrypts the mDoc response using the session key and transmits it to the Verifier App via a session data message. This technical implementation profile only supports Bluetooth Low Energy (BLE) for the communication sub-phase.</p>
</div></blockquote>
<p>The following figure illustrates the flow diagram compliant with ISO 18013-5 for proximity flow.</p>
<figure class="align-center" id="id1" style="width: 100%">
<span id="fig-high-level-flow-itwallet-presentation-iso"></span><a class="reference external image-reference" href="https://www.plantuml.com/plantuml/svg/bL9BZnCn3BxFhx3A0H3q3_ImMlOXXBJYqGguzE9ct2RQn0bvJDb_ZoSP3QFI2xab_Xx-xDocZ34NPpiisNDn1ufT1t9GPH_XUw88cA3KjuF_3QlnwNM2dHDYq9vf1Q-Up4ddErkeme9KZ381ESFg9rfB6JwnEB4IiAYTAuou7nN_Al-WQ8xcVzHd2dm8eKeFI-cMfApNDpVd3Nm9n90rmKLBa3s4I8b441dSWrTm7wcNkq7RD3xxJE07CIhlXmqyq624-CWdF94RYQaSWiP4iAweRzjr1vLvRkOVYIcYY32TWO8c9rSBp_GYWKoSe88LzPtsvx5HKO5xtnCSVVpNibA6ATjE8IyfKr7aBgptVDry0WlPXIBOH2aPpoEcbgzDOJTXIEPui2PfrqROZogki56OfNuvcxkdHv5N9H8eZSnaPLRJwUPU95JTn9P-5J60Tn2AcAZQjJ_MiCljxndUN6texN8Dr-ErSjd0roZrNEUjFDSVaJqaZP6gOMpDK0-61UHglkcJjJL75Cx4NHflAKT30xLGH_41wnLQIDb7FD6C7URSAOZCSfCjxyjSWcHEZBb4slCuTQL9FJVsWDRq9akuxfQuByx-0G00"><img alt="_images/High-Level-Flow-ITWallet-Presentation-ISO.svg" src="_images/High-Level-Flow-ITWallet-Presentation-ISO.svg" /></a>
<figcaption>
<p><span class="caption-text">High-Level Proximity Flow</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><strong>Step 1-3</strong>: The Verifier requests the User to reveal certain attributes from their mDoc(s) stored in the Wallet Instance. The User initiates the Wallet Instance. The Wallet Instance MUST create a new temporary key pair (EDeviceKey.Priv, EDeviceKey.Pub), and incorporate the cipher suite identifier, the identifier of the elliptic curve for key agreement, and the EDeviceKey public point into the device engagement structure (refer to [ISO18013-5#9.1.1.4]). This key pair is temporary and MUST be invalidated immediately after the secure channel is established. Finally, the Wallet Instance displays the QR Code for Device Engagement.</p>
<p>Below an example of a device engagement structure that utilizes QR for device engagement and Bluetooth Low Energy (BLE) for data retrieval.</p>
<p>CBOR data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a30063312e30018201d818584ba4010220012158205a88d182bce5f42efa59943f33359d2e8a968ff289d93e5fa444b624343167fe225820b16e8cf858ddc7690407ba61d4c338237a8cfcf3de6aa672fc60a557aa32fc670281830201a300f401f50b5045efef742b2c4837a9a3b0e1d05a6917</span>
</pre></div>
</div>
<p>In diagnostic notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span> <span class="o">%</span> <span class="n">Version</span>

  <span class="mi">1</span><span class="p">:</span>        <span class="o">%</span> <span class="n">Security</span>
  <span class="p">[</span>
      <span class="mi">1</span><span class="p">,</span>     <span class="o">%</span> <span class="n">defines</span> <span class="n">the</span> <span class="n">cipher</span> <span class="n">suite</span> <span class="mi">1</span> <span class="n">which</span> <span class="n">contains</span> <span class="n">only</span> <span class="n">EC</span> <span class="n">curves</span>
      <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span>  <span class="o">%</span> <span class="n">embedded</span> <span class="n">CBOR</span> <span class="n">data</span> <span class="n">item</span>
        <span class="p">{</span>
          <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="o">%</span> <span class="n">kty</span><span class="p">:</span><span class="n">EC2</span> <span class="p">(</span><span class="n">Elliptic</span> <span class="n">curves</span> <span class="k">with</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span> <span class="n">coordinate</span> <span class="n">pairs</span><span class="p">)</span>
        <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">%</span> <span class="n">crv</span><span class="p">:</span><span class="n">p256</span>
<span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">h</span><span class="s1">&#39;5A88D182BCE5F42EFA59943F33359D2E8A968FF289D93E5FA444B624343  167FE&#39;</span><span class="p">,</span><span class="o">%</span> <span class="n">x</span><span class="o">-</span><span class="n">coordinate</span>
<span class="o">-</span><span class="mi">3</span><span class="p">:</span><span class="n">h</span><span class="s1">&#39;B16E8CF858DDC7690407BA61D4C338237A8CFCF3DE6AA672FC60A557AA32FC67&#39;</span> <span class="o">%</span> <span class="n">y</span><span class="o">-</span><span class="n">coordinate</span>
        <span class="p">}</span>
      <span class="o">&gt;&gt;</span><span class="p">)</span>
    <span class="p">],</span>

    <span class="mi">2</span><span class="p">:</span> <span class="o">%</span><span class="n">DeviceRetrievalMethods</span><span class="p">(</span><span class="n">Device</span> <span class="n">engagement</span> <span class="n">using</span> <span class="n">QR</span> <span class="n">code</span><span class="p">)</span>
    <span class="p">[</span>
      <span class="p">[</span>
        <span class="mi">2</span><span class="p">,</span> <span class="o">%</span><span class="n">BLE</span>
        <span class="mi">1</span><span class="p">,</span> <span class="o">%</span> <span class="n">Version</span>
      <span class="p">{</span>    <span class="o">%</span><span class="n">BLE</span> <span class="n">options</span>
          <span class="mi">0</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="o">%</span> <span class="n">no</span> <span class="n">support</span> <span class="k">for</span> <span class="n">mdoc</span> <span class="n">peripheral</span> <span class="n">server</span> <span class="n">mode</span>
          <span class="mi">1</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="o">%</span> <span class="n">support</span> <span class="n">mdoc</span> <span class="n">central</span> <span class="n">client</span> <span class="n">mode</span>
          <span class="mi">11</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;45EFEF742B2C4837A9A3B0E1D05A6917&#39;</span> <span class="o">%</span> <span class="n">UUID</span> <span class="n">of</span> <span class="n">mdoc</span> <span class="n">client</span> <span class="n">central</span> <span class="n">mode</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Step 4-6</strong>: The Verifier App scans the QR Code and generates its own ephemeral key pair (EReaderKey.Priv, EReaderKey.Pub). It then calculates the session key, using the public key received in the Engagement Structure and its newly-generated private key, as outlined in [ISO18013-5#9.1.1.5]. Finally, it generates its session key, which must be independently derived by both the Wallet Instance and the Verifier App.</p>
<p><strong>Step 7</strong>: The Verifier App creates an mDoc request that MUST be encrypted using the relevant session key, and transmits it to the Wallet Instance along with EReaderKey.Pub within a session establishment message. The mDoc request MUST be encoded in CBOR, as demonstrated in the following non-normative example.</p>
<p>CBOR data:
.. code-block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a26776657273696f6e63312e306b646f63526571756573747381a26c6974656d7352657175657374d818590152a267646f6354797065756f72672e69736f2e31383031332e352e312e6d444c6a6e616d65537061636573a2746f72672e69736f2e31383031332e352e312e4954a375766572696669636174696f6e2e65766964656e6365f4781c766572696669636174696f6e2e6173737572616e63655f6c6576656cf4781c766572696669636174696f6e2e74727573745f6672616d65776f726bf4716f72672e69736f2e31383031332e352e31ab76756e5f64697374696e6775697368696e675f7369676ef47264726976696e675f70726976696c65676573f46f646f63756d656e745f6e756d626572f46a69737375655f64617465f46f69737375696e675f636f756e747279f47169737375696e675f617574686f72697479f46a62697274685f64617465f46b6578706972795f64617465f46a676976656e5f6e616d65f468706f727472616974f46b66616d696c795f6e616d65f46a726561646572417574688443a10126a11821590129308201253081cda00302010202012a300a06082a8648ce3d0403023020311e301c06035504030c15536f6d652052656164657220417574686f72697479301e170d3233313132343130323832325a170d3238313132323130323832325a301a3118301606035504030c0f536f6d6520526561646572204b65793059301306072a8648ce3d020106082a8648ce3d03010703420004aa1092fb59e26ddd182cfdbc85f1aa8217a4f0fae6a6a5536b57c5ef7be2fb6d0dfd319839e6c24d087cd26499ec4f87c8c766200ba4c6218c74de50cd1243b1300a06082a8648ce3d0403020347003044022048466e92226e042add073b8cdc43df5a19401e1d95ab226e142947e435af9db30220043af7a8e7d31646a424e02ea0c853ec9c293791f930bf589bee557370a4c97bf6584058a0d421a7e53b7db0412a196fea50ca6d4c8a530a47dd84d88588ab145374bd0ab2a724cf2ed2facf32c7184591c5969efd53f5aba63194105440bc1904e1b9</span>
</pre></div>
</div>
<p>The above CBOR data is represented in diagnostic notation as follows:
.. code-block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;docRequests&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;itemsRequest&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
      <span class="s2">&quot;docType&quot;</span><span class="p">:</span> <span class="s2">&quot;org.iso.18013.5.1.mDL&quot;</span><span class="p">,</span>
      <span class="s2">&quot;nameSpaces&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;org.iso.18013.5.1.IT&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;verification.evidence&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;verification.assurance_level&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;verification.trust_framework&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">},</span>
        <span class="s2">&quot;org.iso.18013.5.1&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;un_distinguishing_sign&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;driving_privileges&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;document_number&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;issue_date&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;issuing_country&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;issuing_authority&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;birth_date&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;expiry_date&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;given_name&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;portrait&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;family_name&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
    <span class="s2">&quot;readerAuth&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="n">h</span><span class="s1">&#39;a10126&#39;</span><span class="p">,</span>
      <span class="p">{</span>
        <span class="mi">33</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;308201253081cda00302010202012a300a06082a8648ce3d0403023020311e301c06035504030c15536f6d652052656164657220417574686f72697479301e170d3233313132343130323832325a170d3238313132323130323832325a301a3118301606035504030c0f536f6d6520526561646572204b65793059301306072a8648ce3d020106082a8648ce3d03010703420004aa1092fb59e26ddd182cfdbc85f1aa8217a4f0fae6a6a5536b57c5ef7be2fb6d0dfd319839e6c24d087cd26499ec4f87c8c766200ba4c6218c74de50cd1243b1300a06082a8648ce3d0403020347003044022048466e92226e042add073b8cdc43df5a19401e1d95ab226e142947e435af9db30220043af7a8e7d31646a424e02ea0c853ec9c293791f930bf589bee557370a4c97b&#39;</span>
      <span class="p">},</span>
      <span class="n">null</span><span class="p">,</span>
      <span class="n">h</span><span class="s1">&#39;58a0d421a7e53b7db0412a196fea50ca6d4c8a530a47dd84d88588ab145374bd0ab2a724cf2ed2facf32c7184591c5969efd53f5aba63194105440bc1904e1b9&#39;</span>
    <span class="p">]</span>
  <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Step 8</strong>: The Wallet Instance uses the session establishment message to derive the session keys and decrypt the mDoc request. It computes the session key using the public key received from the Verifier App and its private key.</p>
<p><strong>Step 9-10</strong>: When the Wallet Instance receives the mDoc request, it locates the documents that contain the requested attributes and asks the User for permission to provide this information to the Verifier. If the User agrees, the Wallet generates an mDoc response and transmits it to the Verifier App through the secure channel.</p>
<p><strong>Step 11-12</strong>: If the User gives consent, the Wallet Instance creates an mDoc response and transmits it to the Verifier App via the secure channel. The mDoc response MUST be encoded in CBOR, with its structure outlined in [ISO18013-5#8.3.2.1.2.2]. Below is a non-normative example of an mDoc response.</p>
<p>CBOR Data:
.. code-block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a36776657273696f6e63312e3069646f63756d656e747381a367646f6354797065756f72672e69736f2e31383031332e352e312e6d444c6c6973737565725369676e6564a26a6e616d65537061636573a2746f72672e69736f2e31383031332e352e312e495483d81858f7a46864696765737449440b6672616e646f6d506d44f21ee875f2c1d502b43198e5a15271656c656d656e744964656e74696669657275766572696669636174696f6e2e65766964656e63656c656c656d656e7456616c756581a2647479706571656c656374726f6e69635f7265636f7264667265636f7264bf6474797065781f68747470733a2f2f657564692e77616c6c65742e70646e642e676f762e697466736f75726365bf716f7267616e697a6174696f6e5f6e616d65754d6f746f72697a7a617a696f6e6520436976696c656f6f7267616e697a6174696f6e5f6964656d5f696e666c636f756e7472795f636f6465626974ffffd8185866a4686469676573744944046672616e646f6d50185d84dfb71ce9b173010ddd62174fbe71656c656d656e744964656e746966696572781c766572696669636174696f6e2e74727573745f6672616d65776f726b6c656c656d656e7456616c7565656569646173d8185865a4686469676573744944006672616e646f6d50137f903174253c4585358267aae2ea4e71656c656d656e744964656e746966696572781c766572696669636174696f6e2e6173737572616e63655f6c6576656c6c656c656d656e7456616c75656468696768716f72672e69736f2e31383031332e352e318bd8185852a46864696765737449440c6672616e646f6d5053e29d0ddbbc7d2306a32bdbe2e56e5171656c656d656e744964656e7469666965726b66616d696c795f6e616d656c656c656d656e7456616c756563446f65d8185855a4686469676573744944036672616e646f6d50990cba2069fa1b33b8d6ae910b6549dc71656c656d656e744964656e7469666965726a676976656e5f6e616d656c656c656d656e7456616c756567416e746f6e696fd818585ba46864696765737449440a6672616e646f6d504086c1379975f805f1b1f4975e6a126571656c656d656e744964656e7469666965726a69737375655f646174656c656c656d656e7456616c7565d903ec6a323031392d31302d3230d818585ca4686469676573744944016672616e646f6d50ab4ca30c918dd2fd0bf35242c15fa2d871656c656d656e744964656e7469666965726b6578706972795f646174656c656c656d656e7456616c7565d903ec6a323032342d31302d3230d8185855a4686469676573744944076672616e646f6d508d9066f6c8da16619867cd4e2fab0c8871656c656d656e744964656e7469666965726f69737375696e675f636f756e7472796c656c656d656e7456616c7565624954d818587ea4686469676573744944056672616e646f6d5059fe68db795dee4c20976380ea24770571656c656d656e744964656e7469666965727169737375696e675f617574686f726974796c656c656d656e7456616c75657828497374697475746f20506f6c696772616669636f2065205a656363612064656c6c6f20537461746fd818585ba4686469676573744944026672616e646f6d5008b3f1ca5517019767be3dee3bb0614571656c656d656e744964656e7469666965726a62697274685f646174656c656c656d656e7456616c7565d903ec6a313935362d30312d3230d818585ca4686469676573744944096672616e646f6d50a2395ec214350c26066306e23279b3ae71656c656d656e744964656e7469666965726f646f63756d656e745f6e756d6265726c656c656d656e7456616c756569393837363534333231d8185850a4686469676573744944066672616e646f6d50a25e1a5b915d2d6eafee9674e023293971656c656d656e744964656e74696669657268706f7274726169746c656c656d656e7456616c75654420212223d81858eea46864696765737449440d6672616e646f6d50eeed6a3b856563627589a360939d12f771656c656d656e744964656e7469666965727264726976696e675f70726976696c656765736c656c656d656e7456616c756582a37576656869636c655f63617465676f72795f636f646561416a69737375655f64617465d903ec6a323031382d30382d30396b6578706972795f64617465d903ec6a323032342d31302d3230a37576656869636c655f63617465676f72795f636f646561426a69737375655f64617465d903ec6a323031372d30322d32336b6578706972795f64617465d903ec6a323032342d31302d3230d818585ba4686469676573744944086672616e646f6d50c0ef486b2a194ed3cbf7f354fd40092171656c656d656e744964656e74696669657276756e5f64697374696e6775697368696e675f7369676e6c656c656d656e7456616c756561496a697373756572417574688443a10126a118215901423082013e3081e5a00302010202012a300a06082a8648ce3d040302301a3118301606035504030c0f5374617465204f662055746f706961301e170d3233313132343134353430345a170d3238313132323134353430345a30383136303406035504030c2d5374617465204f662055746f7069612049737375696e6720417574686f72697479205369676e696e67204b65793059301306072a8648ce3d020106082a8648ce3d03010703420004c338ec1000b351ce8bcdfc167450aeceb</span>
</pre></div>
</div>
<p>In diagnostic notation:
.. code-block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;documents&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;docType&quot;</span><span class="p">:</span> <span class="s2">&quot;org.iso.18013.5.1.mDL&quot;</span><span class="p">,</span>
    <span class="s2">&quot;issuerSigned&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;nameSpaces&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;org.iso.18013.5.1.IT&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;6d44f21ee875f2c1d502b43198e5a152&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;verification.evidence&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;electronic_record&quot;</span><span class="p">,</span>
                <span class="s2">&quot;record&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;https://eudi.wallet.pdnd.gov.it&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;organization_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Motorizzazione Civile&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;organization_id&quot;</span><span class="p">:</span> <span class="s2">&quot;m_inf&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;country_code&quot;</span><span class="p">:</span> <span class="s2">&quot;it&quot;</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;185d84dfb71ce9b173010ddd62174fbe&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;verification.trust_framework&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="s2">&quot;eidas&quot;</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;137f903174253c4585358267aae2ea4e&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;verification.assurance_level&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="s2">&quot;high&quot;</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="s2">&quot;org.iso.18013.5.1&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;53e29d0ddbbc7d2306a32bdbe2e56e51&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;family_name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="s2">&quot;Doe&quot;</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;990cba2069fa1b33b8d6ae910b6549dc&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;given_name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="s2">&quot;Antonio&quot;</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;4086c1379975f805f1b1f4975e6a1265&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;issue_date&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="mi">1004</span><span class="p">(</span><span class="s2">&quot;2019-10-20&quot;</span><span class="p">)</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;ab4ca30c918dd2fd0bf35242c15fa2d8&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;expiry_date&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="mi">1004</span><span class="p">(</span><span class="s2">&quot;2024-10-20&quot;</span><span class="p">)</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;8d9066f6c8da16619867cd4e2fab0c88&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;issuing_country&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="s2">&quot;IT&quot;</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;59fe68db795dee4c20976380ea247705&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;issuing_authority&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="s2">&quot;Istituto Poligrafico e Zecca dello Stato&quot;</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;08b3f1ca5517019767be3dee3bb06145&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;birth_date&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="mi">1004</span><span class="p">(</span><span class="s2">&quot;1956-01-20&quot;</span><span class="p">)</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;a2395ec214350c26066306e23279b3ae&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;document_number&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="s2">&quot;987654321&quot;</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;a25e1a5b915d2d6eafee9674e0232939&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;portrait&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;20212223&#39;</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;eeed6a3b856563627589a360939d12f7&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;driving_privileges&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;vehicle_category_code&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
                <span class="s2">&quot;issue_date&quot;</span><span class="p">:</span> <span class="mi">1004</span><span class="p">(</span><span class="s2">&quot;2018-08-09&quot;</span><span class="p">),</span>
                <span class="s2">&quot;expiry_date&quot;</span><span class="p">:</span> <span class="mi">1004</span><span class="p">(</span><span class="s2">&quot;2024-10-20&quot;</span><span class="p">)</span>
              <span class="p">},</span>
              <span class="p">{</span>
                <span class="s2">&quot;vehicle_category_code&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span>
                <span class="s2">&quot;issue_date&quot;</span><span class="p">:</span> <span class="mi">1004</span><span class="p">(</span><span class="s2">&quot;2017-02-23&quot;</span><span class="p">),</span>
                <span class="s2">&quot;expiry_date&quot;</span><span class="p">:</span> <span class="mi">1004</span><span class="p">(</span><span class="s2">&quot;2024-10-20&quot;</span><span class="p">)</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
          <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;c0ef486b2a194ed3cbf7f354fd400921&#39;</span><span class="p">,</span>
            <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;un_distinguishing_sign&quot;</span><span class="p">,</span>
            <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="s2">&quot;I&quot;</span>
          <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">)</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s2">&quot;issuerAuth&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">h</span><span class="s1">&#39;a10126&#39;</span><span class="p">,</span>
        <span class="p">{</span>
          <span class="mi">33</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;3082013e3081e5a00302010202012a300a06082a8648ce3d040302301a3118301606035504030c0f5374617465204f662055746f706961301e170d3233313132343134353430345a170d3238313132323134353430345a30383136303406035504030c2d5374617465204f662055746f7069612049737375696e6720417574686f72697479205369676e696e67204b65793059301306072a8648ce3d020106082a8648ce3d03010703420004c338ec1000b351ce8bcdfc167450aeceb7d518bd9a519583e082d67effff06565804fc09abf0e4a08e699c9dba3796285a15f68e40ac7f9fc7700a15153a4065300a06082a8648ce3d040302034800304502210099b7d62e6bf7b1823db3713df889bf73e70bb4d9c58c21e92c58d2f1beffe932022058d039747a00d70e6d66be4797e6142b3608a014ee09b7b79af2cae2aaf27788&#39;</span>
        <span class="p">},</span>
        <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
      <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
      <span class="s2">&quot;digestAlgorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;SHA-256&quot;</span><span class="p">,</span>
      <span class="s2">&quot;docType&quot;</span><span class="p">:</span> <span class="s2">&quot;org.iso.18013.5.1.mDL&quot;</span><span class="p">,</span>
      <span class="s2">&quot;valueDigests&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;org.iso.18013.5.1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="mi">1</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;0E5F0B6B33418E508740771E82F893372EAF5B2445BC4C84DCF08B005E9493FC&#39;</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;DE21BB62FF2897D8B986D2CDA9F9BC5865C02807F7B4D9DD1FA4A79DF4C0D37F&#39;</span><span class="p">,</span>
        <span class="mi">3</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;BC5568239E35CE9FF8798C27FFDCD757B134B679F0FE05729AA3491381912E65&#39;</span><span class="p">,</span>
        <span class="mi">5</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;E6048BDC7FD6454296F1E3F54536107C9C5B24C4064DE46A98121E3630EECCA2&#39;</span><span class="p">,</span>
        <span class="mi">6</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;73690D92DCAA61B0203870F67C6AA9FDFEA889B6F0C720DE757B4B0A8516A206&#39;</span><span class="p">,</span>
        <span class="mi">7</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;E353EA0B0FD92B6BE90C64CC3B2EE1284153A8F0F5066B99AAC599200E6EEEB2&#39;</span><span class="p">,</span>
        <span class="mi">8</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;29227872CEB49923D267B5F4BADE6D387B42AC2DC4B2AE26C9013067FEE7018A&#39;</span><span class="p">,</span>
        <span class="mi">9</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;A6A119F7CACAC0B8C6AACAC747FD3FE7E50B6D9BB8A507FDA79F0DF6646F285D&#39;</span><span class="p">,</span>
        <span class="mi">10</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;6D8025D2F02A5E7E1406FB6AAEB67F9EDE9B07191A53F3E23B77C528223A94E2&#39;</span><span class="p">,</span>
        <span class="mi">12</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;B0D43E4E2EA534E4D5304E64BCF7A0F13E2C8EE8304B9CD23ABA4909652A4647&#39;</span><span class="p">,</span>
        <span class="mi">13</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;FBF4DE318982F2DBAD43C601CAEB22628B301AC18AA8264C5831B2AAAC89C486&#39;</span>
        <span class="p">},</span>
        <span class="s2">&quot;org.iso.18013.5.1.IT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;CF57377B675F64F37314739592C1E8A911A7DDAF341CE2902FE877C5A835E4C1&#39;</span><span class="p">,</span>
        <span class="mi">4</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;4A4B4CC64EC9299C1A2501EA449F577005E9F7A60408057C07A7C67FB151E5F5&#39;</span><span class="p">,</span>
        <span class="mi">11</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;78824FBD6FBBA88A2AAB44DF8B6F5E9759126D87D1F4415995E658FD9239E1FE&#39;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;deviceKeyInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;deviceKey&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;AFD09E720B918CEDC2B8A881950BAB6A1051E18AE16A814D51E609938663D5E1&#39;</span><span class="p">,</span>
        <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;61FBC6C8AD24EC86A78BB4E9AC377DD2B7C711D9F2EB9AFD4AA0963662847AED&#39;</span><span class="p">}},</span>
        <span class="s2">&quot;validityInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;signed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">(</span><span class="s2">&quot;2023-11-24T14:54:05Z&quot;</span><span class="p">),</span>
          <span class="s2">&quot;validFrom&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">(</span><span class="s2">&quot;2023-11-24T14:54:05Z&quot;</span><span class="p">),</span>
          <span class="s2">&quot;validUntil&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">(</span><span class="s2">&quot;2024-11-24T14:54:05Z&quot;</span><span class="p">)}</span>
        <span class="p">}</span>  <span class="o">&gt;&gt;</span><span class="p">),</span>
        <span class="n">h</span><span class="s1">&#39;f2461e4fab69e9f7bcffe552395424514524d1679440036213173101448d1b1ab4a293859b389ffa8b47aeed10e9b0c1545412ac37c51a76482cd9bbbe110152&#39;</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;deviceSigned&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;nameSpaces&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
      <span class="s2">&quot;deviceAuth&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;deviceSignature&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="n">h</span><span class="s1">&#39;a10126&#39;</span><span class="p">,</span>
          <span class="p">{},</span>
          <span class="n">null</span><span class="p">,</span>
          <span class="n">h</span><span class="s1">&#39;1fed7190d2975ab79c072e6f1d9d52436059d1fc959d55baf74f057d89b10fcc0dc77a50d433d4c76ddf26223c5560c4ab123b5cb5eb805a90036aa147493076&#39;</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Step 13</strong>: The Verifier App is required to validate the signatures in the mDoc's issuerSigned field using the public key of the Credential Issuer specified within the mDoc. Subsequently, the Verifier MUST validate the signature in the deviceSigned field. If these signature checks pass, the Verifier can confidently consider the received information as valid.</p>
<section id="device-engagement">
<h2>Device Engagement<a class="headerlink" href="#device-engagement" title="Link to this heading">¶</a></h2>
<p>The Device Engagement structure MUST be have at least the following components:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Version</strong>: <em>tstr</em>. Version of the data structure being used.</p></li>
<li><p><strong>Security</strong>: an array that contains two mandatory values</p>
<ul>
<li><p>the cipher identifier: see Table 22 of [ISO18013-5]</p></li>
<li><p>the mDL public ephemeral key generated by the Wallet Instance and required by the Verifier App to derive the Session Key. The mDL public ephemeral key MUST be of a type allowed by the indicated cipher suite.</p></li>
</ul>
</li>
<li><p><strong>transferMethod</strong>: an array that contains one or more transferMethod arrays when performing device engagement using the QR code. This array is for offline data retrieval methods. A transferMethod array holds two mandatory values (type and version). Only the BLE option is supported by this technical implementation profile, then the type value MUST be set to <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p></li>
<li><p><strong>BleOptions</strong>: this elements MUST provide options for the BLE connection (support for Peripheral Server or Central Client Mode, and the device UUID).</p></li>
</ul>
</div></blockquote>
</section>
<section id="mdoc-request">
<h2>mDoc Request<a class="headerlink" href="#mdoc-request" title="Link to this heading">¶</a></h2>
<p>The messages in the mDoc Request MUST be encoded using CBOR. The resulting CBOR byte string for the mDoc Request MUST be encrypted with the Session Key obtained after the Device Engagement phase and MUST be transmitted using the BLE protocol.
The details on the structure of mDoc Request, including identifier and format of the data elements, are provided below.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>version</strong>: (tstr). Version of the data structure.</p></li>
<li><p><strong>docRequests</strong>: Requested DocType, NameSpace and data elements.</p>
<ul>
<li><p><strong>itemsRequest</strong>: #6.24(bstr .cbor ItemsRequest).</p>
<ul>
<li><p><strong>docType</strong>: (tstr). The DocType element contains the type of document requested. See <a class="reference internal" href="pid-eaa-data-model.html#pid-eaa-data-model-rst"><span class="std std-ref">Data Model Section</span></a>.</p></li>
<li><p><strong>nameSpaces</strong>: (tstr). See <a class="reference internal" href="pid-eaa-data-model.html#pid-eaa-data-model-rst"><span class="std std-ref">Data Model Section</span></a> for more details.</p>
<ul>
<li><p><strong>dataElements</strong>: (tstr). Requested data elements with <em>Intent to Retain</em> value for each requested element.</p>
<ul>
<li><p><strong>IntentToRetain</strong>: (bool). It indicates that the Verifier App intends to retain the received data element.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>readerAuth</strong>: <em>COSE_Sign1</em>. It is required for the Verifier App authentication.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The domestic data elements MUST not be returned unless specifically requested by the Verifier App.</p>
</div>
</section>
<section id="mdoc-response">
<h2>mDoc Response<a class="headerlink" href="#mdoc-response" title="Link to this heading">¶</a></h2>
<p>The messages in the mDoc Response MUST be encoded using CBOR and MUST be encrypted with the Session Key obtained after the Device Engagement phase.
The details on the structure of mDoc Response are provided below.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>version</strong>: (tstr). Version of the data structure.</p></li>
<li><p><strong>documents</strong>: Returned <em>DocType</em>, and <em>ResponseData</em>.</p>
<ul>
<li><p><strong>docType</strong>: (tstr). The DocType element contains the type of document returned. See <a class="reference internal" href="pid-eaa-data-model.html#pid-eaa-data-model-rst"><span class="std std-ref">Data Model Section</span></a>.</p></li>
<li><p><strong>ResponseData</strong>:</p>
<ul>
<li><p><strong>IssuerSigned</strong>: Responded data elements signed by the issuer.</p>
<ul>
<li><p><strong>nameSpaces</strong>: (tstr). See <a class="reference internal" href="pid-eaa-data-model.html#pid-eaa-data-model-rst"><span class="std std-ref">Data Model Section</span></a> for more details.</p>
<ul>
<li><p><strong>IssuerSignedItemBytes</strong>: #6.24(bstr .cbor).</p>
<ul>
<li><p><strong>digestID</strong>: (uint).  Reference value to one of the <strong>ValueDigests</strong> provided in the <em>Mobile Security Object</em> (<cite>issuerAuth</cite>).</p></li>
<li><p><strong>random</strong>: (bstr). Random byte value used as salt for the hash function. This value SHALL be different for each <em>IssuerSignedItem</em> and it SHALL have a minimum length of 16 bytes.</p></li>
<li><p><strong>elementIdentifier</strong>: (tstr). Identifier of User attribute name contained in the Credential.</p></li>
<li><p><strong>elementValue</strong>: (any). User attribute value</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>DeviceSigned</strong>: Responded data elements signed by the Wallet Instance.</p>
<ul>
<li><p><strong>NameSpaces</strong>: #6.24(bstr .cbor DeviceNameSpaces). The DeviceNameSpaces structure MAY be an empty structure. DeviceNameSpaces contains the data element identifiers and values. It is returned as part of the corresponding namespace in DeviceNameSpace.</p>
<ul>
<li><p><strong>DataItemName</strong>: (tstr). The identifier of the element.</p></li>
<li><p><strong>DataItemValue</strong>: (any). The value of the element.</p></li>
</ul>
</li>
<li><p><strong>DeviceAuth</strong>:  The DeviceAuth structure MUST contain the DeviceSignature elements.</p>
<ul>
<li><p><strong>DeviceSignature</strong>: It MUST contain the device signature for the Wallet Instance authentication.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>status</strong>: It contains a status code. For detailed description and action required refer to to Table 8 (ResponseStatus) of the [ISO18013-5]</p></li>
</ul>
</div></blockquote>
</section>
<section id="session-termination">
<h2>Session Termination<a class="headerlink" href="#session-termination" title="Link to this heading">¶</a></h2>
<p>The session MUST be terminated if at least one of the following conditions occur.</p>
<blockquote>
<div><ul class="simple">
<li><p>After a time-out of no activity of receiving or sending session establishment or session data messages occurs. The time-out for no activity implemented by the Wallet Instance and the Verifier App SHOULD be no less than 300 seconds.</p></li>
<li><p>When the Wallet Instance doesn't accept any more requests.</p></li>
<li><p>When the Verifier App does not send any further requests.</p></li>
</ul>
</div></blockquote>
<p>If the Wallet Instance and the Verifier App does not send or receive any further requests, the session termination MUST be initiated as follows.</p>
<blockquote>
<div><ul class="simple">
<li><p>Send the status code for session termination, or</p></li>
<li><p>dispatch the &quot;End&quot; command as outlined in [ISO18013-5#8.3.3.1.1.5].</p></li>
</ul>
</div></blockquote>
<p>When a session is terminated, the Wallet Instance and the Verifier App MUST perform at least the following actions:</p>
<blockquote>
<div><ul class="simple">
<li><p>destruction of session keys and related ephemeral key material;</p></li>
<li><p>closure of the communication channel used for data retrieval.</p></li>
</ul>
</div></blockquote>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents</span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:</span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">Proximity Flow</a><ul>
<li><a class="reference internal" href="#device-engagement">Device Engagement</a></li>
<li><a class="reference internal" href="#mdoc-request">mDoc Request</a></li>
<li><a class="reference internal" href="#mdoc-response">mDoc Response</a></li>
<li><a class="reference internal" href="#session-termination">Session Termination</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
            </div>

            <div class="right">
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
      Last updated on 16/10/2024.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.5.
    </div>

<p id="theme_credit"></p>
  </body>
</html>